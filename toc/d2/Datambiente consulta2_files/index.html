<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="DATAMBIENTE%20consulta2_files/ol.css">
        <link rel="stylesheet" href="DATAMBIENTE%20consulta2_files/fontawesome-all.css">
        <link rel="stylesheet" href="DATAMBIENTE%20consulta2_files/ol3-layerswitcher.css">
        <link rel="stylesheet" href="DATAMBIENTE%20consulta2_files/qgis2web.css">
        <style>
        .ol-geocoder.gcd-gl-container {
            top: 135px!important;
            left: .5em!important;
            width: 2.1em!important;
            height: 2.1em!important;
        }
        .ol-geocoder .gcd-gl-container{
            width: 2.1em!important;
            height: 2.1em!important;
        }
        .ol-geocoder .gcd-gl-control{
            width: 2.1em!important;
        }
        .ol-geocoder .gcd-gl-expanded {
            width: 15.625em!important;
            height: 2.1875em;
        }
        .ol-touch .ol-geocoder.gcd-gl-container{
            top: 180px!important;
        }
        .ol-geocoder .gcd-gl-btn {
            width: 1.375em!important;
            height: 1.375em!important;
            top: .225em!important;
            background-image: none!important;
        }
        </style>
<style>
.search-layer {
  top: 170px;
  left: .5em;
}
.ol-touch .search-layer {
  top: 230px;
}
</style>
        <style>
        html, body {
            background-color: #ffffff;
        }
        .ol-control button {
            background-color: #f8f8f8 !important;
            color: #000000 !important;
            border-radius: 0px !important;
        }
        .ol-zoom, .geolocate, .gcd-gl-control .ol-control {
            background-color: rgba(255,255,255,.4) !important;
            padding: 3px !important;
        }
        .ol-scale-line {
            background: none !important;
        }
        .ol-scale-line-inner {
            border: 2px solid #f8f8f8 !important;
            border-top: none !important;
            background: rgba(255, 255, 255, 0.5) !important;
            color: black !important;
        }
        </style>

        <style>
        .geolocate {
            top: 65px;
            left: .5em;
        }
        .ol-touch .geolocate {
            top: 80px;
        }
        </style>
        <link href="DATAMBIENTE%20consulta2_files/ol3-geocoder.css" rel="stylesheet">
<style>
.tooltip {
  position: relative;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 4px;
  color: white;
  padding: 4px 8px;
  opacity: 0.7;
  white-space: nowrap;
}
.tooltip-measure {
  opacity: 1;
  font-weight: bold;
}
.tooltip-static {
  background-color: #ffcc33;
  color: black;
  border: 1px solid white;
}
.tooltip-measure:before,
.tooltip-static:before {
  border-top: 6px solid rgba(0, 0, 0, 0.5);
  border-right: 6px solid transparent;
  border-left: 6px solid transparent;
  content: "";
  position: absolute;
  bottom: -6px;
  margin-left: -7px;
  left: 50%;
}
.tooltip-static:before {
  border-top-color: #ffcc33;
}
.measure-control {
  top: 100px;
  left: .5em;
}
.ol-touch .measure-control {
  top: 130px;
}
</style>
        <style>
        #map {
            width: 1005px;
            height: 780px;
        }
        </style>
        <title></title>
<script>
function readfile() {
    alert(document.getElementById('iframe').contentDocument.body.firstChild.innerHTML);
}
</script>
<script src='https://kit.fontawesome.com/a076d05399.js'></script>
    </head>
    <body onload="fechaa() " bgcolor=#ffffcc>
<table bgcolor=#f2ffcc>
    <tr><td>NUEVO CASO</td></tr>
    <tr>
    <tr>
        <td>1.Seleccione Archivo COMPARTIDA 2019\CARLOS2019\Sigambiental\Casos.txt"</td>
        <td><input type="file" id="fileToLoad"></td>
        <td><button style='font-size:24px' onclick="loadFileAsText()">2.CARGAR BASE DE DATOS<i class='far fa-keyboard' style='font-size:48px;color:green'></button><td>
    </tr>
    <tr>
    </tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
		    3. Radicado<input type="text" id="radicado">
        </td>
    </tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
		    FECHA.......<input type="text" id="fecha">
        </td>
    </tr>
    <tr>
    </tr>
        <td>4.Tipo de evento</td>
		<td width="100%"><select name="Tipo" id="Tipo" size="1" onchange="Deftipo(this)">
            <option value="Uso del territorio" />Uso del territorio
            <option value="Explotación ilegal" />Explotación ilegal
            <option value="Tala" />Tala
            <option value="Residuos sólidos" />Residuos sólidos
            <option value="Vertimiento" />Vertimiento
            <option value="Contaminación auditiva" />Contaminación auditiva
            <option value="Contaminación atmosferica" />Contaminación atmosferica
            <option value="Contaminación visual" />Contaminación visual
            <option value="Otro" />Otro
            <option selected value="No registrado" />
          </select><br />
         </td>
	</tr>
    <tr>
    </tr>
    <tr>
        <td>5.Vereda</td>
		<td width="100%"><select name="Vereda" id="Vereda" size="1" onchange="Deftipo(this)">
            <option value="Tibitoc Urbano" />Tibitoc Urbano
            <option value="Tibitoc" />Tibitoc
            <option value="Verganzo" />Verganzo
            <option value="La Esmeralda baja" />La Esmeralda baja
            <option value="La Esmeralda alta" />La Esmeralda alta
            <option value="Canavita baja" />Canavita baja
            <option value="Canavita Alta" />Canavita Alta
            <option value="Porvenir" />Porvenir
            <option value="La Fuente" />La Fuente
            <option value="Casco Urbano" />Casco Urbano
            <option selected value="No registrado" />
          </select><br />
         </td>
	</tr>
    <tr>
    </tr>
    <tr>
        <td>6. Resultado?</td>
		<td width="100%"><select name="Sancion" id="Sancion" size="1" onchange="Deftipo(this)">
            <option value="No hubo hallazgo de afectación" />No hay afectación ambiental
            <option value="Sanción verbal" />Sanción verbal
            <option value="No hubo sanción por reclamaciones" />No, reclamaciones
            <option value="Sin sanción por ausencia de autor" />No, autor ausente
            <option value="Sin sanción por autor desconocido" />No, autor desconocido
            <option value="Medida preventiva" />Si, medida preventiva
            <option value="Sanción de código de policia" />Si, código de policia
            <option selected value="No registrado" />
          </select><br />
         </td>
	</tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
		    7. Denunciante........<input type="text" id="Denunciante">
        </td>
    </tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
		    8. Denunciado.........<input type="text" id="denunciado">
        </td>
    </tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
		    9. Magnitud.............<input type="text" id="magnitud">
        </td>
    </tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
		    10.Coordenadas Planas X y Y (si no las tiene, zoom en mapa y click en punto cercano y anote las coordenadas<input type="text" id="ESTE"><input type="text" id="NORTE">
        </td>
    </tr>
    <tr>
    </tr>
	<tr>
		<td colspan="3">
            11. Observaciones<textarea id="Observaciones" cols="30" rows="5"></textarea>
            <textarea id="variables" cols="30" rows="5" style="display:none;"></textarea>
            <textarea id="consolidado" cols="30" rows="5" style="display:none;"></textarea>
        </td>
    </tr>
    <tr>
    </tr>
    <tr>
        <td>12.Digite "Casos.txt"</td>
        <td><input id="inputFileNameToSaveAs" value = "casos.txt" ></input></td>
        <td><input id="basededatos" type="hidden" ></input></td>
        <td><button onclick="saveTextAsFile()">12.SELECCIONE GUARDAR COMO: "CASOS.txt" en COMPARTIDA 2019\CARLOS 2019\Sigambiental\</button></td>
	</tr>
</table>
<a href="ingresardatos.qgz">13. ENTRAR A SISTEMA DE INFORMACION GEOGRAFICA</a> 
<script type="text/javascript">
 
function saveTextAsFile()
{
	document.getElementById("variables").value = document.getElementById("radicado").value + "	" + document.getElementById("fecha").value + "	" + document.getElementById("Tipo").value + "	" + document.getElementById("Vereda").value + "	" + document.getElementById("Sancion").value + "	" + document.getElementById("Denunciante").value + "	" + document.getElementById("denunciado").value + "	" + document.getElementById("magnitud").value + "	" + document.getElementById("ESTE").value + "	" + document.getElementById("NORTE").value + "	" + document.getElementById("Observaciones").value + "\n"
    var textToSave = document.getElementById("consolidado").value + document.getElementById("variables").value;
    var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
    var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
    var fileNameToSaveAs = document.getElementById("inputFileNameToSaveAs").value;
 
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    downloadLink.href = textToSaveAsURL;
    downloadLink.onclick = destroyClickedElement;
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
 
    downloadLink.click();

	document.getElementById("variables").value = "Con el fin de dar respuesta al radicado " + document.getElementById("radicado").value + ", el dia " + document.getElementById("fecha").value + " se procedió a hacer la visita técnica para verificar la denuncia de " + document.getElementById("Tipo").value + " en el sector " + document.getElementById("Vereda").value + " de Tocancipá. El resultado de dicha visita fue " + document.getElementById("Sancion").value + ". El denunciante : " + document.getElementById("Denunciante").value + ". El denunciado : " + document.getElementById("denunciado").value + ". La magnitud del evento fué " + document.getElementById("magnitud").value + ". Las coordenadas planas de el lugar son Este = " + document.getElementById("ESTE").value + " y Norte = " + document.getElementById("NORTE").value + ". Se destacan las siguientes observaciones: " + document.getElementById("Observaciones").value + document.getElementById("Funcionario").value + "                       FIRMA DEL FUNCIONARIO"
    var textToSave = document.getElementById("variables").value + document.getElementById("consolidado").value;
    var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
    var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
    var fileNameToSaveAs = document.getElementById("basededatos").value;
 
    var downloadLink = document.createElement("a");
    downloadLink.download = fileNameToSaveAs;
    downloadLink.innerHTML = "Download File";
    downloadLink.href = textToSaveAsURL;
    downloadLink.onclick = destroyClickedElement;
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
 
    downloadLink.click();

}
 
function destroyClickedElement(event)
{
    document.body.removeChild(event.target);
}
 
function loadFileAsText()
{
    var fileToLoad = document.getElementById("fileToLoad").files[0];
 
    var fileReader = new FileReader();
    fileReader.onload = function(fileLoadedEvent) 
    {
        var textFromFileLoaded = fileLoadedEvent.target.result;
        document.getElementById("consolidado").value = textFromFileLoaded;
    };
    fileReader.readAsText(fileToLoad, "UTF-8");
}

var f = new Date();
document.getElementById("fecha").value = (f.getDate() + "/" + (f.getMonth() +1) + "/" + f.getFullYear());
</script>

<h1>Datos existentes</h1>
<h1 style="font-size:16px">Radicado-Fecha-Tipo evento-Sector-Resultado-Denunciante-Denunciado-Magnitud-Este-Norte-Observaciones</h1>
<iframe id='iframe' src = 'casos.txt' onload='readfile()' width="1600"> </iframe>
        <div id="map">
            
        <div class="ol-viewport" style="position: relative; overflow: hidden; width: 100%; height: 100%; touch-action: none;" data-view="9848"><canvas style="width: 100%; height: 100%; display: block;" class="ol-unselectable" width="1005" height="780"></canvas><div class="ol-overlaycontainer"></div><div class="ol-overlaycontainer-stopevent"><div class="ol-overlay-container ol-selectable" style="position: absolute; display: none;"><div id="popup" class="ol-popup">
                <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                <div id="popup-content"></div>
            </div></div><div class="ol-zoom ol-unselectable ol-control"><button class="ol-zoom-in" type="button" title="Zoom in">+</button><button class="ol-zoom-out" type="button" title="Zoom out">−</button></div><div class="ol-rotate ol-unselectable ol-control ol-hidden"><button class="ol-rotate-reset" type="button" title="Reset rotation"><span class="ol-compass" style="transform: rotate(0rad);">⇧</span></button></div><div class="ol-attribution ol-unselectable ol-control ol-uncollapsible"><ul><li><a href="https://github.com/tomchadwin/qgis2web">qgis2web</a> · </li><li><a href="https://openlayers.org/">OpenLayers</a> · </li><li><a href="https://qgis.org/">QGIS</a></li><li> </li></ul><button type="button" title="Attributions"><span>i</span></button></div><div class="measure-control ol-unselectable ol-control"><button class=" fas fa-ruler "></button></div><div class="geolocate ol-unselectable ol-control"><button class=" fa fa-map-marker"></button></div><div class="ol-geocoder gcd-gl-container"><div class="gcd-gl-control ol-control"><button type="button" class="gcd-gl-btn fa fa-search"></button><input type="text" id="gcd-input-query" class="gcd-gl-input" autocomplete="off" placeholder="Search for ..."><a id="gcd-input-reset" class="gcd-gl-reset gcd-hidden"></a></div><ul class="gcd-gl-result"></ul></div></div></div></div>
        <script src="DATAMBIENTE%20consulta2_files/qgis2web_expressions.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/polyfills.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/functions.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/ol.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/ol3-layerswitcher.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/ol3-geocoder.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/reservaforestalprotectoraproductora138456_0.js"></script><script src="DATAMBIENTE%20consulta2_files/DIFERENCIA_1.js"></script><script src="DATAMBIENTE%20consulta2_files/polmin_2.js"></script><script src="DATAMBIENTE%20consulta2_files/USOACTUALDELSUELO_3.js"></script><script src="DATAMBIENTE%20consulta2_files/Casos_4.js"></script><script src="DATAMBIENTE%20consulta2_files/Educacionambiental_5.js"></script><script src="DATAMBIENTE%20consulta2_files/Industria_6.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/reservaforestalprotectoraproductora138456_0_style.js"></script><script src="DATAMBIENTE%20consulta2_files/DIFERENCIA_1_style.js"></script><script src="DATAMBIENTE%20consulta2_files/polmin_2_style.js"></script><script src="DATAMBIENTE%20consulta2_files/USOACTUALDELSUELO_3_style.js"></script><script src="DATAMBIENTE%20consulta2_files/Casos_4_style.js"></script><script src="DATAMBIENTE%20consulta2_files/Educacionambiental_5_style.js"></script><script src="DATAMBIENTE%20consulta2_files/Industria_6_style.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/layers.js" type="text/javascript"></script> 
        <script src="DATAMBIENTE%20consulta2_files/qgis2web.js"></script>
        <script src="DATAMBIENTE%20consulta2_files/Autolinker.js"></script>
    <script>
//import {register} from 'proj4';
//import {get as getProjection} from 'proj';
//import proj4 from 'proj4';
//proj4.defs('MAGNA-SIRGAS', 'PROJCS["MAGNA-SIRGAS / Colombia Bogota zone', GEOGCS["MAGNA-SIRGAS", DATUM["Marco_Geocentrico_Nacional_de_Referencia", SPHEROID["GRS 1980",6378137,298.257222101, AUTHORITY["EPSG","7019"]], TOWGS84[0,0,0,0,0,0,0], AUTHORITY["EPSG","6686"]], PRIMEM["Greenwich",0, AUTHORITY["EPSG","8901"]], UNIT["degree",0.0174532925199433, AUTHORITY["EPSG","9122"]], AUTHORITY["EPSG","4686"]], PROJECTION["Transverse_Mercator"], PARAMETER["latitude_of_origin",4.596200416666666], PARAMETER["central_meridian",-74.07750791666666], PARAMETER["scale_factor",1], PARAMETER["false_easting",1000000], PARAMETER["false_northing",1000000], UNIT["metre",1, AUTHORITY["EPSG","9001"]], AUTHORITY["EPSG","3116"]]");
//var MAGNA-SIRGAS = getProjection('MAGNA-SIRGAS');
//MAGNA-SIRGAS.setExtent([0, 0, 1300000, 1300000]);
var myFormat = function(dgts)
{
  return (
    function(coord1) {
        var coord2 = [((coord1[1]-4.96683729)*110595)+1040988, ((coord1[0]+73.9132367)*110948)+1018218]; 
      return ol.coordinate.toStringXY(coord2,dgts);
  });        
}

          var mousePosition = new ol.control.MousePosition({
        coordinateFormat: myFormat(2), // <--- change here
        projection: 'EPSG:4326',
        target: document.getElementById("NORTE").value,
        undefinedHTML: '&nbsp;'
      });
      map.addControl(mousePosition);
		document.getElementById("NORTE").value = mousePosition;
    </script>
    <script src="index.js"></script>

</body></html>